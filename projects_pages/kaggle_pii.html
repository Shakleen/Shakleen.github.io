<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content>
    <meta name="author" content>

    <title>Kaggle PII Detection</title>

    <!-- Bootstrap core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link
      href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900"
      rel="stylesheet">
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i"
      rel="stylesheet">
    <link href="../vendor/font-awesome/css/font-awesome.min.css"
      rel="stylesheet">
    <link href="../vendor/devicons/css/devicons.min.css" rel="stylesheet">
    <link href="../vendor/simple-line-icons/css/simple-line-icons.css"
      rel="stylesheet">

    <link rel="stylesheet" type='text/css'
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />

    <!-- Custom styles for this template -->
    <link href="../css/resume.min.css" rel="stylesheet">

  </head>

  <body id="page-top">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top"
      id="sideNav">
      <a class="navbar-brand js-scroll-trigger" href="#page-top">
        <span class="d-block d-lg-none">Kaggle PII Detection</span>
        <span class="d-none d-lg-block">
          <img class="img-fluid img-profile rounded-circle mx-auto mb-2"
            src="../img/Profile.png" alt>
        </span>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="../index.html"><span
                class="fa-stack fa-lg"><i
                  class="fa fa-arrow-left"></i></span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#tldr">TLDR</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#task">Task</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#action">Action</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#result">Result</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#lessons">Lessons
              Learnt</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid p-0">

      <section class="resume-section p-3 p-lg-5 d-flex d-column" id="tldr">
        <div class="my-auto">
          <h1 class="mb-0">Kaggle
            <span class="text-primary">PII Detection</span>
          </h1>
          <div class="subheading"><i class="fa fa-clock-o"></i> January 2024 -
            April 2024
          </div>
          <div class="subheading mb-2"><i class="fa fa-tags"></i> NLP, Deep
            Learning, Ensembling</div>

          <ul class="list-inline list-social-icons mb-3">
            <li class="list-inline-item">Check out the repository at</li>
            <li class="list-inline-item">
              <a
                href="https://github.com/shishir9159/PII-Data-Detection">
                <span class="fa-stack fa-lg">
                  <i class="devicon-github-original"></i>
                </span>
              </a>
            </li>
            <li class="list-inline-item"> and my competition ranking at </li>
            <li class="list-inline-item">
              <a
                href="https://www.kaggle.com/ishfar/competitions">
                <span class="fa-stack fa-lg">
                  <i class="devicon-kaggle-original"></i>
                </span>
              </a>
            </li>
          </ul>

          <p class="mb-5">This was my very first Kaggle competition where I had
            to detect <b>Personally Identifiable Information (PII)</b> from
            essays written by students. The main challenge of the competition
            was dealing with the extreme skew in the dataset. Essays with
            thousands of words had very few PII, if any at all. My solution was
            to use negative sampling, thresholding, and ensemble of multiple
            DeBERTa models to predict tokens as PII. Ultimately, it ranked
            <b>173<sup>rd</sup> out of 2100</b> participants, earning me a
            <b>bronze medal.</b></p>
        </div>
      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="task">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-gear"></i> Task </h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-3">Detect PII from long text sequence</h3>
              <div class="subheading mb-3">Scoring Criteria: F5 metric</div>
              <p>The system is penalized 5 times more for missing a PII than
                falsely detecting one. <b>Recall is 5X more important than
                  precision.</b></p>

              <div class="subheading mb-3">Data</div>

              <p>
                The competition dataset comprises approximately <b>22,000
                  essays</b> written by students. 30% of this data is usable as
                a training set, 70%
                of this data is kept as the leader test set.
              </p>

              <div class="subheading mb-3">Challenge 1: 14 PII
                Types</div>

              <p><b>7 PII types</b> with each type further being split into
                beginning
                or intermediate PII types. For example:</p>

              <div class="table-responsive">
                <table class="table">
                  <thead class="bg-primary text-white">
                    <tr>
                      <th><strong>Seqeunce</strong></th>
                      <th><strong>My</strong></th>
                      <th><strong>name</strong></th>
                      <th><strong>is</strong></th>
                      <th><strong>Shakleen</strong></th>
                      <th><strong>Ishfar</strong></th>
                      <th><strong>and</strong></th>
                      <th><strong>my</strong></th>
                      <th><strong>email</strong></th>
                      <th><strong>is</strong></th>
                      <th><strong>shakleenishfar</strong></th>
                      <th><strong>@gmail.com</strong></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>PII Prediction</strong></td>
                      <td>O</td>
                      <td>O</td>
                      <td>O</td>
                      <td style="color: red;">B-NAME</td>
                      <td style="color: red;">I_NAME</td>
                      <td>O</td>
                      <td>O</td>
                      <td>O</td>
                      <td>O</td>
                      <td style="color: red;">B-EMAIL</td>
                      <td style="color: red;">I_EMAIL</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="subheading mb-3">Challenge 2: Extreme Class
                Imabalnce</div>

              <pi><b>99.9%</b> of tokens aren't PII. Which makes it very
                difficult to successfully predict tokens as PII.</pi>

              <img src="../img/kaggle_pii/Competition_Data.png"
                class="img-fluid"
                alt="https://www.kaggle.com/competitions/pii-detection-removal-from-educational-data/discussion/479491" />
            </div>
          </div>

        </div>

      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="action">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-list-alt"></i> Action</h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-2">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Data Preparation</h3>
            </div>
          </div>

          <div class="row mb-5">
            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Sliding Window</h5>
                  <p class="card-text text-center">Instead of using long
                    sequence lengths, I divided them into overlapping windows of
                    length 512. This allowed me to <b>train models with smaller
                      context window while retaining high performance</b>.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Synthetic Data
                    Generation</h5>
                  <p class="card-text text-center">Competition data lacked every
                    type of PII data. To have the model recognize all 7
                    variations of PII data, I <b>synthetically generated essays
                      with PII using Mixtral-8x7B</b>.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Negative Sampling</h5>
                  <p class="card-text text-center">70% of examples didn't have a
                    single PII. I divided these into 3 separate datasets and
                    then added positive samples to them. This <b>reduced the
                      skewness and resulted in better performing models</b>.</p>
                </div>
              </div>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-2">
            <div class="resume-content">
              <h3 class="mb-0">Prediction</h3>
            </div>
          </div>

          <div class="row mb-4">
            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Weighted Loss Updates</h5>
                  <p class="card-text text-center">As recall is 5 times more
                    important than precision, I wanted to minimize false
                    negatives. Thus, I set class <b>"O"</b> with a very low
                    weight for loss updates, as 99.9% of tokens were of this
                    class and it wasn't PII.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Experiment Tracking and
                    Hyperparameter Tuning</h5>
                  <p class="card-text text-center">Experiments were tracked in
                    <b>Weights and Biases</b> platform. Keeping track of data
                    versions and configurations allowed me to quickly prototype
                    and improve my system. Furthermore, hyperparameter tuning
                    was used to determine optimal values.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Ensemble 3 DeBERTa
                    Models</h5>
                  <p class="card-text text-center">I trained 3 separate
                    DeBERTa-V3-Base models using 3 different folds of the
                    negative sample coupled with the same positive samples. The
                    final ensemble of models was used for inference.</p>
                </div>
              </div>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-2">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Post-processing</h3>
            </div>
          </div>

          <div class="row mb-4">
            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Thresholding</h5>
                  <p class="card-text text-center">If probability of not being a
                    PII is less than 70% then assign the token as a PII. This
                    improves the model's recall metric even more.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Regular Expression</h5>
                  <p class="card-text text-center">Used Regular Expressions to
                    detect <b>Email</b>, <b>Username</b> and <b>Phone number</b>
                    type PII tokens, as they followed a particular pattern.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Assigning "B-" and "I-"
                    tags</h5>
                  <p class="card-text text-center">Iteratively assigned "B-" and
                    "I-" prefixes based on PII indices. As a result,
                    misclassification between "B-" and "I-" types drammatically
                    decreased.</p>
                </div>
              </div>
            </div>
          </div>

        </div>
      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="result">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-line-chart"></i> Result</h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-2">
            <p>Overall the system performs well on the validation dataset. It
              <b>achieved 0.96 F5 score in the validation dataset</b>. This
              translated
              to <b>0.953 on the leaderboard hidden test dataset</b>. As shown
              in the 2nd graph below, it is clear that the model <b>achieved
                0.9+ F5 score for all the PII types</b>.</p>
          </div>

          <div class="row mb-4">
            <div class="col-md-6">
              <div class="card">
                <div class="embed-responsive embed-responsive-16by9">
                  <img src="../img/kaggle_pii/Overall_F1_Recall_Precision.png"
                    class="card-img-top embed-responsive-item" alt="Image">
                </div>
                <div class="card-body">
                  <h5 class="card-title text-center">Overall F5 Score</h5>
                  <p class="card-text text-center">The model has high recall and
                    lower precision. But as recall is 5X more important, it
                    achieves a high F5 score.</p>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="card">
                <div class="embed-responsive embed-responsive-16by9">
                  <img src="../img/kaggle_pii/PII_Specific_F5.png"
                    class="card-img-top embed-responsive-item" alt="Image">
                </div>
                <div class="card-body">
                  <h5 class="card-title text-center">PII-wise F5 Score</h5>
                  <p class="card-text text-center">The model manages to get high F5 score of 0.9+ for all the PII types.</p>
                </div>
              </div>
            </div>
          </div>

          <p>The system ranked <b>173<sup>rd</sup>
              out of 2048</b>, which got me a bronze medal.</p>

        </div>
      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="lessons">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-book"></i> Lessons Learnt</h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Good quality data = Great Performance</h3>
              <p>Thoughout the competition, I experimented with external
                datasets from multiple sources. The best model used only one
                external dataset that was of the highest quality, instead of
                using more data. Thus, data quality matters a lot more than
                quantity in this task.</p>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Handling Extreme Class Imbalance</h3>
              <p>The major challenge of this competition was handling the
                extreme class imbalance. I learnt to use techniques like
                negative sampling, thresholding, ensembling, and weighted loss
                updates to tackle this issue.</p>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Iterative Improvement Requires Experiment
                Tracking</h3>
              <p>Over the span of 2 months, I experimented a lot. Tracking the
                experiment parameters like data version, model version,
                configurations, etc. in a platform helped immensely in
                prototyping.</p>
            </div>
          </div>

        </div>
      </section>

    </div>

    <!-- Bootstrap core JavaScript -->
    <script src="../vendor/jquery/jquery.min.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="../vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="../js/resume.min.js"></script>

  </body>

</html>
