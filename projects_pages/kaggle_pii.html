<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content>
    <meta name="author" content>

    <title>Kaggle PII Detection</title>

    <!-- Bootstrap core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link
      href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900"
      rel="stylesheet">
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i"
      rel="stylesheet">
    <link href="../vendor/font-awesome/css/font-awesome.min.css"
      rel="stylesheet">
    <link href="../vendor/devicons/css/devicons.min.css" rel="stylesheet">
    <link href="../vendor/simple-line-icons/css/simple-line-icons.css"
      rel="stylesheet">

    <link rel="stylesheet" type='text/css'
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />

    <!-- Custom styles for this template -->
    <link href="../css/resume.min.css" rel="stylesheet">

  </head>

  <body id="page-top">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top"
      id="sideNav">
      <a class="navbar-brand js-scroll-trigger" href="#page-top">
        <span class="d-block d-lg-none">Kaggle PII Detection</span>
        <span class="d-none d-lg-block">
          <img class="img-fluid img-profile rounded-circle mx-auto mb-2"
            src="../img/Profile.png" alt>
        </span>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="../index.html"><span
                class="fa-stack fa-lg"><i
                  class="fa fa-arrow-left"></i></span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#tldr">TLDR</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#task">Task</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#action">Action</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#result">Result</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#lessons">Lessons
              Learnt</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid p-0">

      <section class="resume-section p-3 p-lg-5 d-flex d-column" id="tldr">
        <div class="my-auto">
          <h1 class="mb-0">Kaggle
            <span class="text-primary">PII Detection</span>
          </h1>
          <div class="subheading"><i class="fa fa-clock-o"></i> April 2024 -
            Present
          </div>
          <div class="subheading mb-2"><i class="fa fa-tags"></i> NLP, Deep
            Learning, Ensembling</div>

          <ul class="list-inline list-social-icons mb-3">
            <li class="list-inline-item">Check out the repository at</li>
            <li class="list-inline-item">
              <a
                href="https://github.com/shishir9159/PII-Data-Detection">
                <span class="fa-stack fa-lg">
                  <i class="devicon-github-original"></i>
                </span>
              </a>
            </li>
            <li class="list-inline-item"> and my competition ranking at </li>
            <li class="list-inline-item">
              <a
                href="https://www.kaggle.com/ishfar/competitions">
                <span class="fa-stack fa-lg">
                  <i class="devicon-kaggle-original"></i>
                </span>
              </a>
            </li>
          </ul>

          <p class="mb-5">This was my very first Kaggle competition where I had
            to detect <b>Personally Identifiable Information (PII)</b> from
            essays written by students. The main challenge of the competition
            was dealing with the extreme skew in the dataset. Essays with
            thousands of words had very few PII, if any at all. My solution was
            to use negative sampling, thresholding, and ensemble of multiple
            DeBERTa models to predict tokens as PII. Ultimately, it ranked
            <b>173<sup>rd</sup> out of 2100</b> participants, earning me a
            <b>bronze medal.</b></p>
        </div>
      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="task">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-gear"></i> Task </h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-3">Detect PII from long text sequence</h3>
              <div class="subheading mb-3">Scoring Criteria: F5 metric</div>
              <p>The system is penalized 5 times more for missing an PII than
                falsely detecting one.</p>

              <div class="subheading mb-3">Data</div>

              <p>
                The competition dataset comprises approximately <b>22,000
                  essays</b> written by students. 30% of this data is usable as
                a training set, 70%
                of this data is kept as the leader test set.
              </p>

              <div class="subheading mb-3">Challenge 1: Different PII
                Types</div>

              <p>7 PII types with each type further being split into beginning
                or intermediate PII types. For example:</p>

              <div class="table-responsive">
                <table class="table">
                  <thead class="bg-primary text-white">
                    <tr>
                      <th><strong>Seqeunce</strong></th>
                      <th><strong>My</strong></th>
                      <th><strong>name</strong></th>
                      <th><strong>is</strong></th>
                      <th><strong>Shakleen</strong></th>
                      <th><strong>Ishfar</strong></th>
                      <th><strong>and</strong></th>
                      <th><strong>my</strong></th>
                      <th><strong>email</strong></th>
                      <th><strong>is</strong></th>
                      <th><strong>shakleenishfar</strong></th>
                      <th><strong>@gmail.com</strong></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>PII Prediction</strong></td>
                      <td>O</td>
                      <td>O</td>
                      <td>O</td>
                      <td style="color: red;">B-NAME</td>
                      <td style="color: red;">I_NAME</td>
                      <td>O</td>
                      <td>O</td>
                      <td>O</td>
                      <td>O</td>
                      <td style="color: red;">B-EMAIL</td>
                      <td style="color: red;">I_EMAIL</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="subheading mb-3">Challenge 2: Extreme Class
                Imabalnce</div>

              <pi><b>99.9%</b> of tokens aren't PII. Which makes it very
                difficult to successfully predict tokens as PII.</pi>

              <img src="../img/kaggle_pii/Competition_Data.png"
                class="img-fluid"
                alt="https://www.kaggle.com/competitions/pii-detection-removal-from-educational-data/discussion/479491" />
            </div>
          </div>

        </div>

      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="action">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-list-alt"></i> Action</h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-2">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Data Preparation</h3>
            </div>
          </div>

          <div class="row mb-5">
            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Sliding Window</h5>
                  <p class="card-text text-center">Instead of using long
                    sequence lengths, I divided them into overlapping windows of
                    length 512. This allowed me to <b>train models with smaller
                    context window while retaining high performance</b>.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Synthetic Data
                    Generation</h5>
                  <p class="card-text text-center">Competition data lacked every
                    type of PII data. To have the model recognize all 7
                    variations of PII data, I <b>synthetically generated essays
                    with PII using Mixtral-8x7B</b>.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title text-center">Negative Sampling</h5>
                  <p class="card-text text-center">70% of examples didn't have a
                    single PII. I divided these into 3 separate datasets and
                    then added positive samples to them. This <b>reduced the
                    skewness and resulted in better performing models</b>.</p>
                </div>
              </div>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content">
              <h3 class="mb-0">Feature Engineering</h3>
              <div class="subheading mb-1">Token features</div>
              <p>Basic statistical descriptors (mean, max, sum) for token
                (character, word, sentence).</p>

              <div class="subheading mb-1">Word Vector Features</div>
              <p>TF-IDF and cTF-IDF vectors</p>

              <div class="subheading mb-1">Writing Quality Features</div>
              <p>Uncommon word count, mispelled word count, grammar score,
                etc.</p>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Predictiion</h3>
              <div class="subheading mb-1">7-Fold DeBERTa Ensemble</div>
              <p>Microsoft's DeBERTa-V3-Large predicted score probabilities
                only
                from essay text.</p>

              <div class="subheading mb-1">25-Fold Light GBM Ensemble</div>
              <p>Predicted score from DeBERTa ensemble probabilities and
                engineered features.</p>
            </div>
          </div>

        </div>
      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="result">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-line-chart"></i> Result</h2>

          <div class="row mb-4">
            <p>Experimentation was tracked using <b>Weights and Biases</b> to
              quickly iterate and improve predictive performance. Additional
              experimentation details and results can be found in the
              repository wiki.

              <p><b>Cross-validation performance</b> for a select few
                experiments are shown below:</p></p>
          </div>

          <div class="row mb-4">
            <div class="col-md-4">
              <div class="card">
                <div class="embed-responsive embed-responsive-16by9">
                  <img src="../img/kaggle_ase/QWK_score.png"
                    class="card-img-top embed-responsive-item" alt="Image">
                </div>
                <div class="card-body">
                  <h5 class="card-title text-center">QWK Score</h5>
                  <p class="card-text text-center">Combining LGBM and DeBERTa
                    ensemble gives
                    the best performance</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="embed-responsive embed-responsive-16by9">
                  <img src="../img/kaggle_ase/F1_Score.png"
                    class="card-img-top embed-responsive-item" alt="Image">
                </div>
                <div class="card-body">
                  <h5 class="card-title text-center">F1 Score</h5>
                  <p class="card-text text-center">LGBM has high
                    classification
                    performance across all classes.</p>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card">
                <div class="embed-responsive embed-responsive-16by9">
                  <img src="../img/kaggle_ase/Confusion_Matrix.png"
                    class="card-img-top embed-responsive-item" alt="Image">
                </div>
                <div class="card-body">
                  <h5 class="card-title text-center">Confusion Matrix</h5>
                  <p class="card-text text-center">Predicted scores have
                    minimal
                    difference from ground truth.</p>
                </div>
              </div>
            </div>
          </div>

          <p>The best system so far has score 0.793 in the public
            leaderboard.</p>

        </div>
      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column"
        id="lessons">
        <div class="my-auto">
          <h2 class="mb-5"><i class="fa fa-book"></i> Lessons Learnt</h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Engineering good features = great
                performance</h3>
              <p>Well engineered features coupled with Deep Neural Networks
                outperform standalone deep neural networks.</p>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Poor CV Strategy = Bad Leaderboard
                Performance</h3>
              <p>Kaggle competitions require a good CV strategy that
                correlates
                well with public leaderboard. In the beginning, I had a poor
                CV
                strategy where I got great CV performance but terrible
                leaderboard performance.</p>
            </div>
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <h3 class="mb-0">Iterative Improvement Requires Experiment
                Tracking</h3>
              <p>Over the span of 2 months, I experimented a lot. Tracking the
                experiment parameters like data version, model version,
                configurations, etc. in a platform helped immensely in
                prototyping.</p>
            </div>
          </div>

        </div>
      </section>

    </div>

    <!-- Bootstrap core JavaScript -->
    <script src="../vendor/jquery/jquery.min.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="../vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="../js/resume.min.js"></script>

  </body>

</html>
